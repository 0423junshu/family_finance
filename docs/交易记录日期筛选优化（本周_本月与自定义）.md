# 交易记录日期筛选优化（本周/本月与自定义）

## Core Features

- 本周/本月筛选正确计算本地时区的起止日期并仅返回区间内数据（含边界）

- 自定义日期选择面板保持可见，快速选项与自定义模式共存（切换不自动关闭）

- 开始/结束日期字段可正常选择、互相约束（end &gt;= start），一键应用筛选

- 筛选时重置列表与分页、重新拉取数据，正确显示“已加载全部数据”

- 统一日期比较口径（去除 toISOString().split('T')[0] UTC偏移，使用本地格式/时间戳）

- 保留最近一次筛选状态，切换筛选源（周/月/自定义）不会被页面初始化逻辑覆盖

## Tech Stack

{
  "Web": {
    "arch": "html",
    "component": "tdesign"
  }
}

## Design

筛选UI采用TDesign Popup + Tabs（快速/自定义）+ DateTimePicker + Button。快速选项点击仅更新起止字段与高亮，不关闭面板；自定义区提供两个日期选择器与“重置/应用”按钮；面板外点击才关闭。状态机包含：filterMode（week|month|custom）、startDate、endDate、panelVisible、loading、pageNo/pageSize/hasMore。

## Plan

Note: 

- [ ] is holding
- [/] is doing
- [X] is done

---

[X] step1_现状排查与用例列举

[/] step2_方案确认与交互状态图

[ ] step3_实现本地时区日期工具与区间计算(getWeekRange/getMonthRange/dateOnly)

[ ] step4_重构筛选状态机与UI（不自动关闭面板）绑定onStartChange/onEndChange/onQuickSelect/onApply

[ ] step5_数据层：筛选触发时重置分页并重新加载，修正已加载全部逻辑

[ ] step6_回归测试：周/月边界、跨月、8月31与月首边界、任意自定义区间、快速切换

[ ] step7_文档与问题记录：更新docs/需求文档.md与docs/问题记录.md
