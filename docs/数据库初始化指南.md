# 数据库初始化指南

## 问题描述
登录成功后出现数据库集合不存在错误：
```
database collection not exists | errMsg: [ResourceNotFound] Db or Table not exist
```

## 解决方案

### 1. 部署 initDatabase 云函数
1. 右键点击 `cloudfunctions/initDatabase` 文件夹
2. 选择"上传并部署：云端安装依赖"
3. 等待部署完成

### 2. 运行数据库初始化
1. 部署完成后，右键点击 `cloudfunctions/initDatabase` 文件夹
2. 选择"本地调试"或"云端测试"
3. 点击"调用"按钮运行云函数

### 3. 验证集合创建
在云开发控制台的数据库面板中，应该看到以下集合：
- `families` - 家庭信息
- `family_members` - 家庭成员
- `family_invites` - 家庭邀请
- `transactions` - 交易记录
- `categories` - 分类信息
- `accounts` - 账户信息
- `data_conflicts` - 数据冲突
- `data_locks` - 数据锁
- `data_versions` - 数据版本

### 4. 测试家庭功能
初始化完成后，重新测试：
- 登录功能
- 创建家庭
- 加入家庭
- 家庭信息获取

## 预期结果
- ✅ 所有数据库集合创建成功
- ✅ 家庭功能正常工作
- ✅ 无数据库相关错误

## 注意事项
- 只需要运行一次初始化
- 如果集合已存在，云函数会跳过创建
- 初始化过程是安全的，不会影响现有数据