# 问题修复记录：登录后跳转覆盖目标页

时间: 2025-09-07 17:00
问题: 未登录从家庭/加入页跳转到登录页后，登录成功出现“闪烁并回首页”，未回到目标页
根因: 登录页 pages/login/login.js 在已登录检查与登录成功回调中统一 wx.switchTab('/pages/index/index')，覆盖了家庭/加入页的预期返回
修复:
- family.js/join-family.js 在跳转登录时附带 redirect 参数（目标页路径）
- login.js:
  - onLoad(options) 解析并保存 redirect
  - 新增 navigateAfterLogin()：优先根据 redirect 执行 wx.redirectTo 到目标页；否则回首页
  - 将已登录检查与登录成功后的跳转统一为 this.navigateAfterLogin()
验证建议:
- 从未登录状态进入家庭/加入页，跳到登录页 -> 登录成功应返回对应目标页
- 从其它页面进入登录页，无 redirect 时登录后回首页
影响范围: 仅登录后跳转逻辑，其他功能不受影响