<!-- pages/assets/assets.wxml -->
<view class="safe-area-wrapper safe-area-white">
  <navigation-bar title="家庭财务管理" show-back="{{false}}" class="transparent-navbar" />
</view>

<view class="container">
  <!-- 顶部统计卡片（与首页一致，紧凑版） -->
  <view class="stats-card stats-card--compact">
    <view class="stats-header">
      <view class="month-selector" bindtap="showMonthPicker">
        <text class="stats-title">资产总览</text>
        <view class="date-display">
          <text class="stats-subtitle">{{currentYear}}年{{currentMonth + 1}}月</text>
          <text class="date-status">{{dateStatus}}</text>
        </view>
        <text class="month-arrow">📅</text>
      </view>
    </view>
    
    <view class="stats-content">
      <view class="stat-item">
        <text class="stat-label">总资产</text>
        <text class="stat-value">¥{{totalAssetsDisplay}}</text>
      </view>
      <view class="stat-item income">
        <text class="stat-label">账户余额</text>
        <text class="stat-value">¥{{accountsTotalDisplay}}</text>
      </view>
      <view class="stat-item">
        <text class="stat-label">投资持仓</text>
        <text class="stat-value">¥{{investmentsTotalDisplay}}</text>
      </view>
    </view>
  </view>

  <!-- 账户列表 -->
  <view class="section">
    <view class="section-header">
      <text class="section-title">账户</text>
      <view class="add-btn" bindtap="onAddAccount">
        <text class="add-icon">+</text>
      </view>
    </view>
    
    <view class="account-list">
      <view 
        wx:for="{{accounts}}" 
        wx:key="id"
        class="account-item"
        data-id="{{item.id}}"
        data-account="{{item}}"
        bindtap="onEditAccount"
      >
        <view class="account-icon">{{item.icon}}</view>
        <view class="account-info">
          <text class="account-name">{{item.name}}</text>
          <text class="account-type">
            <block wx:if="{{item.type === 'cash'}}">现金</block>
            <block wx:elif="{{item.type === 'bank'}}">银行卡</block>
            <block wx:else>电子钱包</block>
          </text>
        </view>
        <view class="account-balance">
          <text class="balance-amount">¥{{item.balanceDisplay}}</text>
        </view>
      </view>
    </view>
  </view>
  


  <!-- 投资理财 -->
  <view class="section">
    <view class="section-header">
      <text class="section-title">投资理财</text>
      <view class="add-btn" bindtap="onAddInvestment">
        <text class="add-icon">+</text>
      </view>
    </view>
    
    <view class="investment-list">
      <view 
        wx:for="{{investments}}" 
        wx:key="id"
        class="investment-item"
        data-id="{{item.id}}"
        bindtap="onInvestmentTap"
      >
        <view class="investment-icon">{{item.icon}}</view>
        <view class="investment-info">
          <text class="investment-name">{{item.name}}</text>
          <text class="investment-type">
            <block wx:if="{{item.type === 'fund'}}">基金</block>
            <block wx:else>股票</block>
          </text>
        </view>
        <view class="investment-data">
          <text class="investment-amount">¥{{item.amountDisplay}}</text>
          <text class="investment-profit {{item.profit >= 0 ? 'positive' : 'negative'}}">
            <block wx:if="{{item.profit >= 0}}">+</block>{{item.profitDisplay}} ({{item.profitRate}}%)
          </text>
        </view>
      </view>
    </view>
  </view>
  

  


  <!-- 月份选择器弹窗 -->
  <view class="picker-modal" wx:if="{{showMonthPicker}}" bindtap="cancelMonthPicker">
    <view class="picker-content" catchtap="noop">
      <view class="picker-header">
        <text class="picker-title">选择月份</text>
        <text class="picker-close" bindtap="cancelMonthPicker">×</text>
      </view>
      
      <view class="picker-body">
        <view class="picker-info">
          <text class="current-selection">当前选择：{{selectedYear}}年{{selectedMonth + 1}}月</text>
        </view>
        
        <picker-view 
          indicator-style="height: 50px;" 
          style="width: 100%; height: 250px;" 
          value="{{[selectedYear - startYear, selectedMonth]}}" 
          bindchange="onMonthPickerChange"
        >
          <picker-view-column>
            <view wx:for="{{yearRange}}" wx:key="*this" style="line-height: 50px; text-align: center;">{{item}}年</view>
          </picker-view-column>
          <picker-view-column>
            <view wx:for="{{12}}" wx:key="*this" style="line-height: 50px; text-align: center;">{{item + 1}}月</view>
          </picker-view-column>
        </picker-view>
      </view>
      
      <view class="picker-footer">
        <button class="cancel-btn" bindtap="cancelMonthPicker">取消</button>
        <button class="confirm-btn" bindtap="confirmMonthPicker">确认</button>
      </view>
    </view>
  </view>
</view>