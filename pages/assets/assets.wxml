<!-- pages/assets/assets.wxml -->
<view class="safe-area-wrapper safe-area-white">
  <navigation-bar title="å®¶åº­è´¢åŠ¡ç®¡ç†" show-back="{{false}}" class="transparent-navbar" />
</view>

<view class="container">
  <!-- é¡¶éƒ¨ç»Ÿè®¡å¡ç‰‡ï¼ˆä¸é¦–é¡µä¸€è‡´ï¼Œç´§å‡‘ç‰ˆï¼‰ -->
  <view class="stats-card stats-card--compact">
    <view class="stats-header">
      <view class="month-selector" bindtap="showMonthPicker">
        <text class="stats-title">èµ„äº§æ€»è§ˆ</text>
        <view class="date-display">
          <text class="stats-subtitle">{{currentYear}}å¹´{{currentMonth + 1}}æœˆ</text>
          <text class="date-status">{{dateStatus}}</text>
        </view>
        <text class="month-arrow">ğŸ“…</text>
      </view>
    </view>
    
    <view class="stats-content">
      <view class="stat-item">
        <text class="stat-label">æ€»èµ„äº§</text>
        <text class="stat-value">Â¥{{totalAssetsDisplay}}</text>
      </view>
      <view class="stat-item income">
        <text class="stat-label">è´¦æˆ·ä½™é¢</text>
        <text class="stat-value">Â¥{{accountsTotalDisplay}}</text>
      </view>
      <view class="stat-item">
        <text class="stat-label">æŠ•èµ„æŒä»“</text>
        <text class="stat-value">Â¥{{investmentsTotalDisplay}}</text>
      </view>
    </view>
  </view>

  <!-- è´¦æˆ·åˆ—è¡¨ -->
  <view class="section">
    <view class="section-header">
      <text class="section-title">è´¦æˆ·</text>
      <view class="add-btn" bindtap="onAddAccount">
        <text class="add-icon">+</text>
      </view>
    </view>
    
    <view class="account-list">
      <view 
        wx:for="{{accounts}}" 
        wx:key="id"
        class="account-item"
        data-id="{{item.id}}"
        data-account="{{item}}"
        bindtap="onEditAccount"
      >
        <view class="account-icon">{{item.icon}}</view>
        <view class="account-info">
          <text class="account-name">{{item.name}}</text>
          <text class="account-type">
            <block wx:if="{{item.type === 'cash'}}">ç°é‡‘</block>
            <block wx:elif="{{item.type === 'bank'}}">é“¶è¡Œå¡</block>
            <block wx:else>ç”µå­é’±åŒ…</block>
          </text>
        </view>
        <view class="account-balance">
          <text class="balance-amount">Â¥{{item.balanceDisplay}}</text>
        </view>
      </view>
    </view>
  </view>
  


  <!-- æŠ•èµ„ç†è´¢ -->
  <view class="section">
    <view class="section-header">
      <text class="section-title">æŠ•èµ„ç†è´¢</text>
      <view class="add-btn" bindtap="onAddInvestment">
        <text class="add-icon">+</text>
      </view>
    </view>
    
    <view class="investment-list">
      <view 
        wx:for="{{investments}}" 
        wx:key="id"
        class="investment-item"
        data-id="{{item.id}}"
        bindtap="onInvestmentTap"
      >
        <view class="investment-icon">{{item.icon}}</view>
        <view class="investment-info">
          <text class="investment-name">{{item.name}}</text>
          <text class="investment-type">
            <block wx:if="{{item.type === 'fund'}}">åŸºé‡‘</block>
            <block wx:else>è‚¡ç¥¨</block>
          </text>
        </view>
        <view class="investment-data">
          <text class="investment-amount">Â¥{{item.amountDisplay}}</text>
          <text class="investment-profit {{item.profit >= 0 ? 'positive' : 'negative'}}">
            <block wx:if="{{item.profit >= 0}}">+</block>{{item.profitDisplay}} ({{item.profitRate}}%)
          </text>
        </view>
      </view>
    </view>
  </view>
  

  


  <!-- æœˆä»½é€‰æ‹©å™¨å¼¹çª— -->
  <view class="picker-modal" wx:if="{{showMonthPicker}}" bindtap="cancelMonthPicker">
    <view class="picker-content" catchtap="noop">
      <view class="picker-header">
        <text class="picker-title">é€‰æ‹©æœˆä»½</text>
        <text class="picker-close" bindtap="cancelMonthPicker">Ã—</text>
      </view>
      
      <view class="picker-body">
        <view class="picker-info">
          <text class="current-selection">å½“å‰é€‰æ‹©ï¼š{{selectedYear}}å¹´{{selectedMonth + 1}}æœˆ</text>
        </view>
        
        <picker-view 
          indicator-style="height: 50px;" 
          style="width: 100%; height: 250px;" 
          value="{{[selectedYear - startYear, selectedMonth]}}" 
          bindchange="onMonthPickerChange"
        >
          <picker-view-column>
            <view wx:for="{{yearRange}}" wx:key="*this" style="line-height: 50px; text-align: center;">{{item}}å¹´</view>
          </picker-view-column>
          <picker-view-column>
            <view wx:for="{{12}}" wx:key="*this" style="line-height: 50px; text-align: center;">{{item + 1}}æœˆ</view>
          </picker-view-column>
        </picker-view>
      </view>
      
      <view class="picker-footer">
        <button class="cancel-btn" bindtap="cancelMonthPicker">å–æ¶ˆ</button>
        <button class="confirm-btn" bindtap="confirmMonthPicker">ç¡®è®¤</button>
      </view>
    </view>
  </view>
</view>